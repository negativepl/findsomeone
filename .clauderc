# FindSomeone - Mapa Pamiƒôci Projektu dla Claude

## üìã PRZEGLƒÑD PROJEKTU

**Nazwa:** FindSomeone
**Typ:** Platforma og≈Çosze≈Ñ lokalnych i us≈Çug
**Status:** Produkcja (findsomeone.app)
**Wersja:** 1.0.0
**Autor:** Marcin Baszewski (@negativepl)
**Licencja:** Non-Commercial MIT

### Opis
FindSomeone to nowoczesna platforma webowa do publikowania i przeglƒÖdania og≈Çosze≈Ñ lokalnych. Obs≈Çuguje r√≥≈ºne typy og≈Çosze≈Ñ: sprzeda≈º pojazd√≥w, wynajem nieruchomo≈õci, oferty pracy, wynajem sprzƒôtu, us≈Çugi i wiƒôcej. Projekt wykorzystuje zaawansowane funkcje AI, semantyczne wyszukiwanie, chatbota asystenta oraz nowoczesny, responsywny interfejs.

---

## üõ†Ô∏è STOS TECHNOLOGICZNY

### Frontend
- **Next.js 16.0.1** - App Router, Server Components, Server Actions, Turbopack
- **React 19.2.0** - Najnowsza wersja z React Compiler
- **TypeScript 5** - Silne typowanie
- **Tailwind CSS 4** - Stylowanie (z PostCSS)
- **shadcn/ui** - Komponenty UI (bazujƒÖce na Radix UI)
- **Framer Motion 12.23.24** - Animacje i przej≈õcia
- **React Hook Form 7.64.0** - ZarzƒÖdzanie formularzami
- **Zod 4.1.12** - Walidacja schemat√≥w

### Backend & Baza Danych
- **Supabase** - PostgreSQL 15+, Authentication, Realtime, Storage
- **pgvector** - Wyszukiwanie wektorowe dla embedding√≥w AI
- **Row Level Security (RLS)** - Bezpiecze≈Ñstwo na poziomie bazy danych

### AI & Machine Learning
- **OpenAI API** - GPT-4o mini (chat), text-embedding-3-small (embeddingi)
- **Hugging Face** - Moderacja tre≈õci (wykrywanie spamu i tre≈õci obra≈∫liwych)
- Semantyczne wyszukiwanie z pgvector

### Dodatkowe Us≈Çugi
- **Vercel** - Hosting, deployment, analytics, speed insights
- **Resend** - Wysy≈Çka emaili
- **Upstash Redis** - Rate limiting
- **Lottie** - Animacje (lottie-react)
- **TipTap** - Rich text editor (WYSIWYG)

### PWA
- **@ducanh2912/next-pwa** - Progressive Web App support
- Service Worker automatycznie generowany
- Manifest w /public/manifest.json
- Ikony w /public/icons/

---

## üìÅ STRUKTURA PROJEKTU

### G≈Ç√≥wne katalogi:

```
findsomeone/
‚îú‚îÄ‚îÄ app/                          # Next.js 16 App Router
‚îÇ   ‚îú‚îÄ‚îÄ (auth)/                  # Grupa routingu auth
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login/              # Strona logowania
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ signup/             # Strona rejestracji
‚îÇ   ‚îú‚îÄ‚îÄ about/                  # Strona "O nas"
‚îÇ   ‚îú‚îÄ‚îÄ admin/                  # Panel administracyjny
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ audit-logs/        # Logi akcji admina
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ categories/        # ZarzƒÖdzanie kategoriami
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ chat-assistant/    # ZarzƒÖdzanie AI chatem
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ content-bot/       # Generator tre≈õci AI
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ embeddings/       # ZarzƒÖdzanie embeddingami
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ moderation/       # Moderacja post√≥w
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ reports/          # Raporty u≈ºytkownik√≥w
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ synonyms/         # Generator synonim√≥w AI
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ users/            # ZarzƒÖdzanie u≈ºytkownikami
‚îÇ   ‚îú‚îÄ‚îÄ api/                   # API Routes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/            # Endpointy admina
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ai-chat/          # AI Navigator Bot
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ posts/            # Endpointy post√≥w
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ users/            # Endpointy u≈ºytkownik√≥w
‚îÇ   ‚îú‚îÄ‚îÄ banned/                # Strona dla zbanowanych
‚îÇ   ‚îú‚îÄ‚îÄ category/              # PrzeglƒÖdanie kategorii
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ [...slug]/        # Dynamiczne strony kategorii
‚îÇ   ‚îú‚îÄ‚îÄ contact/               # Formularz kontaktowy
‚îÇ   ‚îú‚îÄ‚îÄ dashboard/             # Dashboard u≈ºytkownika
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ favorites/        # Ulubione og≈Çoszenia
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ messages/         # System wiadomo≈õci
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ my-posts/         # ZarzƒÖdzanie og≈Çoszeniami
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ profile/          # Profil u≈ºytkownika
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ settings/         # Ustawienia u≈ºytkownika
‚îÇ   ‚îú‚îÄ‚îÄ faq/                   # FAQ
‚îÇ   ‚îú‚îÄ‚îÄ how-it-works/          # Jak to dzia≈Ça
‚îÇ   ‚îú‚îÄ‚îÄ install/               # Instrukcja instalacji PWA
‚îÇ   ‚îú‚îÄ‚îÄ posts/                 # PrzeglƒÖdanie og≈Çosze≈Ñ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ [id]/             # Szczeg√≥≈Çy og≈Çoszenia
‚îÇ   ‚îú‚îÄ‚îÄ privacy/               # Polityka prywatno≈õci
‚îÇ   ‚îú‚îÄ‚îÄ profile/               # Publiczne profile
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ [userId]/         # Strona profilu u≈ºytkownika
‚îÇ   ‚îú‚îÄ‚îÄ terms/                 # Regulamin
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx             # Root layout
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx               # Strona g≈Ç√≥wna
‚îÇ   ‚îî‚îÄ‚îÄ globals.css            # Globalne style
‚îÇ
‚îú‚îÄ‚îÄ components/                # Komponenty React
‚îÇ   ‚îú‚îÄ‚îÄ admin/                # Komponenty panelu admina
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AIChatSettings.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AuditLogs.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CategoryManager.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ EmbeddingManager.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MessageReports.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ModerationQueue.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SynonymGenerator.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UserManagement.tsx
‚îÇ   ‚îú‚îÄ‚îÄ chat/                 # Komponenty AI Navigator
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AIChatButton.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AIChatInterface.tsx
‚îÇ   ‚îú‚îÄ‚îÄ ui/                   # Komponenty UI (shadcn/ui)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ button.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ card.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dialog.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ input.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ form.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ select.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tabs.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tooltip.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ... (inne komponenty shadcn)
‚îÇ   ‚îú‚îÄ‚îÄ Footer.tsx            # Stopka z GitHub badge
‚îÇ   ‚îú‚îÄ‚îÄ Logo.tsx              # Logo aplikacji
‚îÇ   ‚îú‚îÄ‚îÄ MobileDock.tsx        # Mobilny dok nawigacyjny
‚îÇ   ‚îú‚îÄ‚îÄ Navbar.tsx            # G≈Ç√≥wna nawigacja
‚îÇ   ‚îú‚îÄ‚îÄ NavbarWithHide.tsx    # Nawigacja z auto-ukrywaniem
‚îÇ   ‚îî‚îÄ‚îÄ PostCard.tsx          # Karta og≈Çoszenia
‚îÇ
‚îú‚îÄ‚îÄ lib/                       # Biblioteki i narzƒôdzia
‚îÇ   ‚îú‚îÄ‚îÄ actions/              # Server Actions
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin.ts         # Akcje admina
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ messages.ts      # Akcje wiadomo≈õci
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ posts.ts         # Akcje post√≥w
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ search.ts        # Silnik wyszukiwania AI
‚îÇ   ‚îú‚îÄ‚îÄ supabase/            # Klienty Supabase
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ client.ts        # Klient dla Client Components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middleware.ts    # Klient dla middleware
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ server.ts        # Klient dla Server Components
‚îÇ   ‚îú‚îÄ‚îÄ types/               # Typy TypeScript
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ database.ts      # Typy tabel Supabase
‚îÇ   ‚îú‚îÄ‚îÄ admin.ts             # Funkcje pomocnicze admina
‚îÇ   ‚îî‚îÄ‚îÄ utils.ts             # Funkcje narzƒôdziowe
‚îÇ
‚îú‚îÄ‚îÄ contexts/                 # React Context providers
‚îÇ
‚îú‚îÄ‚îÄ hooks/                    # Custom React hooks
‚îÇ
‚îú‚îÄ‚îÄ supabase/                 # Konfiguracja Supabase
‚îÇ   ‚îú‚îÄ‚îÄ migrations/          # Migracje SQL
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 20250110_add_user_preferences.sql
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 20250111000000_create_cities_table.sql
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 20250111120000_add_embeddings.sql
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 20250111120001_user_search_history.sql
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 20250111130000_add_post_moderation.sql
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ... (inne migracje)
‚îÇ   ‚îî‚îÄ‚îÄ config.toml          # Konfiguracja Supabase
‚îÇ
‚îú‚îÄ‚îÄ public/                   # Pliki statyczne
‚îÇ   ‚îú‚îÄ‚îÄ icons/               # Ikony PWA
‚îÇ   ‚îú‚îÄ‚îÄ images/              # Obrazy
‚îÇ   ‚îî‚îÄ‚îÄ manifest.json        # Manifest PWA
‚îÇ
‚îú‚îÄ‚îÄ docs/                     # Dokumentacja
‚îÇ   ‚îú‚îÄ‚îÄ ai/                  # Dokumentacja funkcji AI
‚îÇ   ‚îú‚îÄ‚îÄ architecture/        # Dokumentacja architektury
‚îÇ   ‚îú‚îÄ‚îÄ compliance/          # Dokumentacja prawna i moderacji
‚îÇ   ‚îú‚îÄ‚îÄ setup/               # Przewodniki konfiguracji
‚îÇ   ‚îî‚îÄ‚îÄ tests/               # Raporty test√≥w
‚îÇ
‚îú‚îÄ‚îÄ scripts/                  # Skrypty narzƒôdziowe
‚îÇ   ‚îú‚îÄ‚îÄ tests/               # Skrypty testowe
‚îÇ   ‚îî‚îÄ‚îÄ utils/               # Narzƒôdzia diagnostyczne
‚îÇ
‚îú‚îÄ‚îÄ email-templates/          # Szablony emaili (React Email)
‚îÇ
‚îú‚îÄ‚îÄ proxy.ts                  # Proxy (nastƒôpca middleware)
‚îú‚îÄ‚îÄ next.config.ts           # Konfiguracja Next.js
‚îú‚îÄ‚îÄ tsconfig.json            # Konfiguracja TypeScript
‚îú‚îÄ‚îÄ tailwind.config.ts       # Konfiguracja Tailwind CSS
‚îú‚îÄ‚îÄ components.json          # Konfiguracja shadcn/ui
‚îú‚îÄ‚îÄ package.json             # Zale≈ºno≈õci projektu
‚îú‚îÄ‚îÄ vercel.json              # Konfiguracja Vercel
‚îî‚îÄ‚îÄ clear-cache.sh           # Skrypt czyszczenia cache
```

---

## üóÑÔ∏è SCHEMAT BAZY DANYCH (Supabase PostgreSQL)

### G≈Ç√≥wne tabele:

#### `profiles`
Rozszerza auth.users o dodatkowe informacje o u≈ºytkowniku
```sql
- id: UUID (FK -> auth.users.id)
- full_name: TEXT
- bio: TEXT
- phone: TEXT
- city: TEXT
- avatar_url: TEXT
- banner_url: TEXT (nowe pole)
- rating: DECIMAL (≈õrednia ocen)
- is_admin: BOOLEAN
- is_banned: BOOLEAN
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
- privacy_settings: JSONB (ustawienia prywatno≈õci)
```
**RLS:** U≈ºytkownicy mogƒÖ edytowaƒá tylko swoje profile

#### `posts`
Og≈Çoszenia u≈ºytkownik√≥w
```sql
- id: UUID (PK)
- user_id: UUID (FK -> profiles.id)
- category_id: UUID (FK -> categories.id)
- title: TEXT
- description: TEXT
- city: TEXT
- price_min: DECIMAL
- price_max: DECIMAL
- images: TEXT[] (URLs z Supabase Storage)
- status: TEXT (active/inactive/expired)
- moderation_status: TEXT (pending/approved/rejected)
- embedding: VECTOR(1536) (OpenAI embedding dla semantycznego wyszukiwania)
- views_count: INTEGER
- phone_clicks: INTEGER (nowe pole)
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
- expires_at: TIMESTAMP
```
**Indeksy:**
- HNSW (semantyczne wyszukiwanie)
- GIN (full-text search)
- Trigram (tolerancja liter√≥wek)

**RLS:** Publiczny odczyt, edycja tylko przez w≈Ça≈õciciela

#### `categories`
Kategorie og≈Çosze≈Ñ
```sql
- id: UUID (PK)
- name: TEXT
- slug: TEXT (UNIQUE)
- description: TEXT
- seo_description: TEXT (dla SEO)
- icon: TEXT (nazwa ikony Lucide)
- parent_id: UUID (FK -> categories.id, dla podkategorii)
- sort_order: INTEGER
- is_active: BOOLEAN
- created_at: TIMESTAMP
```
**RLS:** Publiczny odczyt, edycja tylko admin

#### `messages`
Prywatne wiadomo≈õci miƒôdzy u≈ºytkownikami
```sql
- id: UUID (PK)
- sender_id: UUID (FK -> profiles.id)
- receiver_id: UUID (FK -> profiles.id)
- post_id: UUID (FK -> posts.id, opcjonalnie)
- content: TEXT
- read: BOOLEAN
- reported: BOOLEAN
- report_reason: TEXT
- created_at: TIMESTAMP
```
**RLS:** Dostƒôp tylko dla nadawcy i odbiorcy
**Realtime:** Subskrypcje dla live updates

#### `favorites`
Ulubione og≈Çoszenia u≈ºytkownik√≥w
```sql
- id: UUID (PK)
- user_id: UUID (FK -> profiles.id)
- post_id: UUID (FK -> posts.id)
- created_at: TIMESTAMP
```
**RLS:** U≈ºytkownicy widzƒÖ tylko swoje ulubione

#### `reviews`
Oceny i recenzje u≈ºytkownik√≥w
```sql
- id: UUID (PK)
- reviewer_id: UUID (FK -> profiles.id)
- reviewee_id: UUID (FK -> profiles.id)
- post_id: UUID (FK -> posts.id, opcjonalnie)
- rating: INTEGER (1-5)
- comment: TEXT
- created_at: TIMESTAMP
```
**RLS:** Publiczny odczyt, uwierzytelnieni u≈ºytkownicy mogƒÖ dodawaƒá

#### `search_analytics`
Analityka wyszukiwania
```sql
- id: UUID (PK)
- user_id: UUID (FK -> profiles.id, nullable)
- query: TEXT
- results_count: INTEGER
- clicked_post_id: UUID (FK -> posts.id, nullable)
- ip_address: TEXT
- created_at: TIMESTAMP
```
**Funkcje:**
- Rate limiting (10 zapyta≈Ñ/10s na IP)
- Trending queries

#### `synonyms`
Synonimy dla wyszukiwania (generowane przez AI)
```sql
- id: UUID (PK)
- term: TEXT
- synonym: TEXT
- status: TEXT (pending/approved/rejected)
- generated_by_ai: BOOLEAN
- created_by: UUID (FK -> profiles.id, nullable)
- created_at: TIMESTAMP
```
**RLS:** Admin zarzƒÖdza

#### `category_synonyms`
Synonimy specyficzne dla kategorii
```sql
- id: UUID (PK)
- category_id: UUID (FK -> categories.id)
- term: TEXT
- synonym: TEXT
- status: TEXT (pending/approved/rejected)
- created_at: TIMESTAMP
```
**RLS:** Admin zarzƒÖdza

#### `admin_audit_logs`
Logi akcji administracyjnych
```sql
- id: UUID (PK)
- admin_id: UUID (FK -> profiles.id)
- action_type: TEXT (create/update/delete/approve/reject/ban/unban)
- target_table: TEXT
- target_id: UUID
- old_values: JSONB
- new_values: JSONB
- ip_address: TEXT
- user_agent: TEXT
- created_at: TIMESTAMP
```
**RLS:** Dostƒôp tylko dla admin√≥w
**Automatyczne czyszczenie:** Usuwanie log√≥w starszych ni≈º 2 lata (Supabase scheduler, niedziele 2:00)

#### `ai_chat_settings`
Ustawienia AI Navigator Bot
```sql
- id: UUID (PK)
- enabled: BOOLEAN
- model: TEXT (np. 'gpt-4o-mini')
- system_prompt: TEXT
- max_tokens: INTEGER
- temperature: DECIMAL
- updated_at: TIMESTAMP
- updated_by: UUID (FK -> profiles.id)
```
**RLS:** Admin zarzƒÖdza, publiczny odczyt statusu enabled

#### `ai_chat_conversations`
Historia konwersacji z chatbotem
```sql
- id: UUID (PK)
- user_id: UUID (FK -> profiles.id, nullable)
- session_id: TEXT
- messages: JSONB (tablica {role, content})
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
```
**RLS:** U≈ºytkownicy majƒÖ dostƒôp tylko do swoich konwersacji

#### `site_content_embeddings`
Embeddingi statycznej tre≈õci strony dla AI
```sql
- id: UUID (PK)
- content_type: TEXT (faq/guide/policy/about)
- title: TEXT
- content: TEXT
- url: TEXT
- embedding: VECTOR(1536)
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
```
U≈ºywane przez AI Navigator do odpowiadania na pytania o stronƒô

#### `cities`
Lista miast polskich
```sql
- id: UUID (PK)
- name: TEXT
- province: TEXT
- created_at: TIMESTAMP
```

#### `user_preferences`
Preferencje u≈ºytkownik√≥w
```sql
- user_id: UUID (FK -> profiles.id)
- theme: TEXT (light/dark/system)
- language: TEXT
- notifications_enabled: BOOLEAN
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
```

---

## üîß FUNKCJE POSTGRESQL

### Wyszukiwanie
- **`search_posts_hybrid()`** - Hybrydowe wyszukiwanie (semantyczne + full-text)
  - Parametry: query_text, similarity_threshold, semantic_weight (0.6), fulltext_weight (0.4)
  - Zwraca: posty z po≈ÇƒÖczonym wynikiem similarity
- **Auto-generowanie embedding√≥w** - Trigger przy dodawaniu/edycji post√≥w

### Moderacja
- **Automatyczne logowanie akcji admina** - Trigger na wszystkich tabelach
- **Trigger do update'u ≈õredniej oceny u≈ºytkownika** - Po dodaniu review

### Cleanup
- **Automatyczne usuwanie starych audit logs** - Funkcja wywo≈Çywana przez Supabase scheduler (niedziele 2:00)

---

## ü§ñ FUNKCJE AI

### 1. Semantyczne Wyszukiwanie (pgvector)
**Lokalizacja:** `lib/actions/search.ts`, migracje bazy danych
**Technologia:** OpenAI text-embedding-3-small (1536 wymiar√≥w)
**Implementacja:**
- Hybrid search: 60% semantyczne + 40% full-text
- HNSW index dla szybkiego wyszukiwania wektorowego
- Trigram index dla tolerancji liter√≥wek
- Auto-generowanie embedding√≥w przy tworzeniu/edycji post√≥w

**Przyk≈Çad u≈ºycia:**
```sql
SELECT * FROM search_posts_hybrid(
  query_text := 'hydraulik warszawa',
  similarity_threshold := 0.7,
  semantic_weight := 0.6,
  fulltext_weight := 0.4
)
```

### 2. AI Navigator Bot (OpenAI GPT)
**Lokalizacja:** `app/api/ai-chat/`, `components/chat/`
**Model:** GPT-4o mini (konfigurowalny w panelu admina)
**Funkcje:**
- Chatbot pomagajƒÖcy znale≈∫ƒá og≈Çoszenia
- Naturalna konwersacja z u≈ºytkownikami
- Integracja z semantycznym wyszukiwaniem
- Streaming responses (Server-Sent Events)
- Context-aware (historia konwersacji)
- Przeszukiwanie tre≈õci strony (FAQ, guides) przez embeddingi

**Komponenty:**
- `AIChatButton.tsx` - Przycisk otwierajƒÖcy chat
- `AIChatInterface.tsx` - Interfejs chatu
- `app/api/ai-chat/route.ts` - API endpoint

### 3. Moderacja Tre≈õci (Hugging Face)
**Lokalizacja:** `app/api/moderate/`, `app/admin/moderation/`
**Funkcje:**
- Automatyczna weryfikacja og≈Çosze≈Ñ
- Wykrywanie spamu i tre≈õci obra≈∫liwych
- Status: pending ‚Üí approved/rejected
- Kolejka moderacji w panelu admina

### 4. Generator Synonim√≥w (OpenAI GPT)
**Lokalizacja:** `app/admin/synonyms/`, `components/admin/SynonymGenerator.tsx`
**Tryby:**
- Trending (z najpopularniejszych zapyta≈Ñ)
- Popular (z najczƒô≈õciej klikanych)
- Custom (rƒôczne wprowadzanie)
- System review & approve
- Integracja z full-text search

### 5. Content Bot (Generator Og≈Çosze≈Ñ AI)
**Lokalizacja:** `app/admin/content-bot/`
**Funkcje:**
- Masowe generowanie post√≥w do test√≥w/demo
- Tre≈õƒá specyficzna dla kategorii
- Konfigurowalna ilo≈õƒá i parametry

---

## üîå API ROUTES

### Publiczne
- `GET /api/posts` - Lista og≈Çosze≈Ñ (z filtrowaniem, paginacjƒÖ)
- `GET /api/posts/[id]` - Szczeg√≥≈Çy og≈Çoszenia
- `POST /api/ai-chat` - Chat z AI Navigator (streaming)
- `GET /api/categories` - Lista kategorii

### WymagajƒÖce autoryzacji
- `POST /api/posts` - Tworzenie og≈Çoszenia
- `PUT /api/posts/[id]` - Edycja og≈Çoszenia
- `DELETE /api/posts/[id]` - Usuwanie og≈Çoszenia
- `POST /api/messages` - Wysy≈Çanie wiadomo≈õci
- `GET /api/users/me` - Dane zalogowanego u≈ºytkownika

### Admin
- `POST /api/admin/moderate` - Moderacja post√≥w
- `PUT /api/admin/users/[id]/ban` - Banowanie u≈ºytkownika
- `POST /api/admin/categories` - ZarzƒÖdzanie kategoriami
- `GET /api/admin/audit-logs` - Logi akcji admina
- `POST /api/admin/embeddings/regenerate` - Regeneracja embedding√≥w
- `PUT /api/admin/chat-settings` - Konfiguracja AI chata

---

## üîê BEZPIECZE≈ÉSTWO

### Row Level Security (RLS)
Wszystkie tabele chronione politykami RLS:
- U≈ºytkownicy widzƒÖ tylko swoje dane
- Wiadomo≈õci dostƒôpne tylko dla uczestnik√≥w
- Admin ma pe≈Çen dostƒôp (przez funkcje security definer)

### Rate Limiting
- **Wyszukiwanie:** 10 req/10s na IP (PostgreSQL)
- **API endpoints:** Upstash Redis rate limiting
- **AI chat:** Ograniczenie zapyta≈Ñ na sesjƒô

### Walidacja
- **Schematy Zod** dla wszystkich formularzy
- **Server-side validation** w Server Actions
- **XSS protection** - sanityzacja input√≥w
- **CSRF protection** - tokeny Next.js

### Autoryzacja
- **Supabase Auth** - JWT tokens w cookies
- **OAuth providers:** Google
- **RLS policies** - sprawdzanie auth.uid()

---

## üìä KLUCZOWE KOMPONENTY

### Nawigacja
- **`Navbar.tsx`** - G≈Ç√≥wny navbar z logo, search, user menu
- **`NavbarWithHide.tsx`** - Navbar z auto-ukrywaniem przy scrollu
- **`MobileDock.tsx`** - Mobilny bottom dock z gestami (vaul)
- **`Footer.tsx`** - Stopka z linkami i GitHub badge

### Og≈Çoszenia
- **`PostCard.tsx`** - Karta og≈Çoszenia (lista)
- **`app/posts/[id]/page.tsx`** - Szczeg√≥≈Çy og≈Çoszenia
- **`app/dashboard/my-posts/page.tsx`** - ZarzƒÖdzanie w≈Çasnymi og≈Çoszeniami
- **`lib/actions/posts.ts`** - Server Actions dla post√≥w

### Dashboard
- **`app/dashboard/messages/`** - System wiadomo≈õci (Realtime)
- **`app/dashboard/favorites/`** - Ulubione og≈Çoszenia
- **`app/dashboard/profile/`** - Edycja profilu
- **`app/dashboard/settings/`** - Ustawienia u≈ºytkownika

### Admin Panel
- **`ModerationQueue.tsx`** - Kolejka moderacji post√≥w
- **`UserManagement.tsx`** - ZarzƒÖdzanie u≈ºytkownikami
- **`CategoryManager.tsx`** - ZarzƒÖdzanie kategoriami
- **`AuditLogs.tsx`** - Logi akcji admina
- **`SynonymGenerator.tsx`** - Generator synonim√≥w AI
- **`EmbeddingManager.tsx`** - ZarzƒÖdzanie embeddingami
- **`AIChatSettings.tsx`** - Ustawienia AI chata

### Formularze
- **React Hook Form** - ZarzƒÖdzanie stanem formularzy
- **Zod** - Walidacja schemat√≥w
- **shadcn/ui form components** - Komponenty UI

---

## üé® STYLING & UI

### Design System
- **Tailwind CSS 4** - Utility-first CSS framework
- **shadcn/ui** - Komponenty bazujƒÖce na Radix UI
- **next-themes** - Dark/light mode
- **Framer Motion** - Animacje i przej≈õcia
- **CSS Variables** - Dla themowania (w globals.css)

### Typografia
- **Font:** System fonts (Inter fallback)
- **Icons:** Lucide React, Tabler Icons React

### Kolory (ciemny motyw - g≈Ç√≥wny)
Paleta zdefiniowana w globals.css poprzez CSS variables:
- `--background`, `--foreground`
- `--card`, `--card-foreground`
- `--primary`, `--primary-foreground`
- `--secondary`, `--secondary-foreground`
- `--muted`, `--muted-foreground`
- `--accent`, `--accent-foreground`
- `--destructive`, `--destructive-foreground`

### Responsywno≈õƒá
- **Mobile-first approach**
- **Breakpoints:** sm, md, lg, xl, 2xl (Tailwind defaults)
- **Mobile dock** dla lepszej nawigacji na urzƒÖdzeniach mobilnych

---

## üåê ROUTING & NAWIGACJA

### App Router (Next.js 16)
- **Route groups:** `(auth)` dla stron logowania/rejestracji
- **Dynamic routes:** `[id]`, `[...slug]` dla post√≥w i kategorii
- **Parallel routes:** Nie u≈ºywane obecnie
- **Intercepting routes:** Nie u≈ºywane obecnie

### G≈Ç√≥wne ≈õcie≈ºki:
```
/                           # Strona g≈Ç√≥wna
/(auth)/login              # Logowanie
/(auth)/signup             # Rejestracja
/posts                     # Lista og≈Çosze≈Ñ
/posts/[id]                # Szczeg√≥≈Çy og≈Çoszenia
/category/[...slug]        # Kategoria og≈Çosze≈Ñ
/dashboard                 # Dashboard u≈ºytkownika
/dashboard/my-posts        # Moje og≈Çoszenia
/dashboard/messages        # Wiadomo≈õci
/dashboard/favorites       # Ulubione
/dashboard/profile         # Profil
/dashboard/settings        # Ustawienia
/admin                     # Panel admina
/admin/moderation          # Moderacja
/admin/users               # U≈ºytkownicy
/admin/categories          # Kategorie
/admin/synonyms            # Synonimy
/admin/embeddings          # Embeddingi
/admin/chat-assistant      # Ustawienia AI chata
/admin/audit-logs          # Logi akcji admina
/about                     # O nas
/contact                   # Kontakt
/faq                       # FAQ
/how-it-works              # Jak to dzia≈Ça
/privacy                   # Polityka prywatno≈õci
/terms                     # Regulamin
/install                   # Instrukcja instalacji PWA
/profile/[userId]          # Publiczny profil u≈ºytkownika
/banned                    # Strona dla zbanowanych
```

---

## üí¨ SYSTEM WIADOMO≈öCI (Realtime)

### Technologia
- **Supabase Realtime** - WebSocket subscriptions
- **PostgreSQL triggers** - Auto-update
- **RLS policies** - Bezpiecze≈Ñstwo

### Funkcje
- Prywatne wiadomo≈õci miƒôdzy u≈ºytkownikami
- Real-time delivery (bez od≈õwie≈ºania)
- Wska≈∫niki online/offline presence
- System raportowania wiadomo≈õci
- Licznik nieprzeczytanych wiadomo≈õci
- Kontekst og≈Çoszenia (opcjonalnie)

### Implementacja
**Lokalizacja:** `app/dashboard/messages/`, `lib/actions/messages.ts`

**Subskrypcja Realtime:**
```typescript
supabase
  .channel('messages')
  .on('postgres_changes', {
    event: 'INSERT',
    schema: 'public',
    table: 'messages',
    filter: `receiver_id=eq.${userId}`
  }, handleNewMessage)
  .subscribe()
```

---

## üîç WYSZUKIWANIE

### Typy wyszukiwania:

#### 1. Semantic Search (AI)
- **Embedding model:** text-embedding-3-small (1536 wymiar√≥w)
- **Vector DB:** pgvector z HNSW index
- **Threshold:** 0.7 (konfigurowalny)
- **Waga:** 60% w hybrid search

#### 2. Full-Text Search (PostgreSQL)
- **Index:** GIN (tsvector)
- **Jƒôzyk:** Polish (pl)
- **Waga:** 40% w hybrid search

#### 3. Trigram Search
- **Index:** GIN trigram (pg_trgm)
- **Funkcja:** Tolerancja liter√≥wek
- **Podobie≈Ñstwo:** > 0.3

#### 4. Hybrid Search (po≈ÇƒÖczenie)
**Funkcja:** `search_posts_hybrid()`
- ≈ÅƒÖczy semantic + full-text
- Konfigurowalne wagi
- Sortowanie po combined score
- Filtrowanie po kategorii, mie≈õcie, cenie

### Auto-complete & Suggestions
- **≈πr√≥d≈Ço:** search_analytics, trending queries
- **Cache:** React Query (5 min)
- **Synonimy:** Z tabeli synonyms, category_synonyms

---

## üìß EMAILE

### Technologia
- **Resend** - Email delivery API
- **@react-email/render** - Renderowanie React komponent√≥w do HTML

### Szablony
**Lokalizacja:** `email-templates/`
- Welcome email (nowe konto)
- Post approved/rejected (moderacja)
- New message notification
- Password reset

### Styl
- Ciemny motyw (zgodny z aplikacjƒÖ)
- Responsywne (mobile-friendly)
- Inline CSS

---

## üöÄ DEPLOYMENT & DEVOPS

### Hosting
- **Vercel** - Hosting Next.js app
- **Supabase** - Backend (PostgreSQL, Auth, Storage, Realtime)

### CI/CD
- Auto-deploy przy push na main branch
- Preview deployments dla PR-√≥w
- Vercel Analytics & Speed Insights

### Environment Variables (Production)
```
NEXT_PUBLIC_SUPABASE_URL=...
NEXT_PUBLIC_SUPABASE_ANON_KEY=...
OPENAI_API_KEY=...
RESEND_API_KEY=...
UPSTASH_REDIS_REST_URL=...
UPSTASH_REDIS_REST_TOKEN=...
```

### Build
```bash
npm run build          # Next.js build z Turbopack
npm run start          # Production server
```

### Development
```bash
npm run dev            # Dev server z Turbopack
npm run dev:clean      # Dev server z czyszczeniem cache
npm run lint           # ESLint
```

---

## üì¶ KLUCZOWE ZALE≈ªNO≈öCI

### UI & Styling
- `tailwindcss` - CSS framework
- `@radix-ui/*` - Primitives dla shadcn/ui
- `framer-motion` - Animacje
- `lucide-react` - Ikony
- `next-themes` - Obs≈Çuga dark mode
- `class-variance-authority` - Warianty komponent√≥w
- `tailwind-merge` - ≈ÅƒÖczenie klas Tailwind

### Forms & Validation
- `react-hook-form` - Formularze
- `@hookform/resolvers` - Resolvers dla Zod
- `zod` - Schema validation

### Data Fetching & State
- `@tanstack/react-query` - Server state management
- `@supabase/ssr` - Supabase SSR
- `@supabase/supabase-js` - Supabase client

### AI & APIs
- `openai` - OpenAI API client
- `resend` - Email API client
- `@upstash/ratelimit` - Rate limiting
- `@upstash/redis` - Redis client

### Rich Text & Content
- `@tiptap/react` - Rich text editor
- `@tiptap/starter-kit` - TipTap extensions
- `react-markdown` - Markdown renderer

### Animations & Effects
- `lottie-react` - Lottie animations
- `gsap` - Animation library
- `cobe` - 3D globe
- `framer-motion` - Animacje React

### PWA
- `@ducanh2912/next-pwa` - Progressive Web App support
- `nprogress` - Loading bar
- `nextjs-toploader` - Top loading indicator

### DnD & Utilities
- `@dnd-kit/core` - Drag and drop
- `@dnd-kit/sortable` - Sortable lists
- `browser-image-compression` - Kompresja obraz√≥w
- `sonner` - Toast notifications
- `vaul` - Drawer component
- `cmdk` - Command palette

---

## üéØ KONWENCJE KODOWANIA

### TypeScript
- **Strict mode** w≈ÇƒÖczony
- Wszystkie komponenty w TypeScript
- Typy importowane z `lib/types/database.ts`
- Brak `any` - u≈ºywamy `unknown` lub konkretnych typ√≥w

### React Components
- **Server Components** jako domy≈õlne
- **'use client'** tylko gdy potrzebne (interaktywno≈õƒá, hooks)
- **'use server'** dla Server Actions
- Komponenty UI w `components/ui/` (shadcn)
- Komponenty biznesowe w `components/`

### Server Actions
- **Lokalizacja:** `lib/actions/`
- Zawsze z `'use server'`
- Walidacja Zod na poczƒÖtku
- Error handling z try/catch
- Zwracanie `{ success: boolean, data?, error? }`

### Nazewnictwo
- **Komponenty:** PascalCase (np. `PostCard.tsx`)
- **Pliki utility:** camelCase (np. `utils.ts`)
- **Server Actions:** camelCase (np. `createPost()`)
- **API routes:** kebab-case folders (np. `ai-chat/`)

### Styling
- **Tailwind classes** - g≈Ç√≥wny spos√≥b stylowania
- **CSS modules** - UNIKAMY (preferujemy Tailwind)
- **Globals.css** - tylko CSS variables i globalne resety
- **cn()** utility - do ≈ÇƒÖczenia klas (z utils.ts)

### Git Conventions
- **Branches:** feature/*, bugfix/*, hotfix/*
- **Commits:** Conventional Commits (feat:, fix:, docs:, etc.)
- **Polish language** w commitach

---

## üß™ TESTOWANIE

### Skrypty testowe
**Lokalizacja:** `scripts/tests/`
- Diagnostyka po≈ÇƒÖcze≈Ñ
- Testy embedding√≥w
- Testy wyszukiwania

### Manualne testowanie
- Profil u≈ºytkownika i edycja
- Tworzenie, edycja, usuwanie post√≥w
- System wiadomo≈õci (realtime)
- Wyszukiwanie (semantic + full-text)
- AI chatbot
- Panel admina (moderacja, bany, kategorie)
- PWA installation

---

## üìö DOKUMENTACJA

### Lokalizacja
**G≈Ç√≥wny folder:** `docs/`

### Podkatalogi:
- **`ai/`** - Dokumentacja funkcji AI (embeddings, search, chatbot)
- **`architecture/`** - Dokumentacja architektury aplikacji
- **`compliance/`** - RODO, moderacja, polityki
- **`setup/`** - Przewodniki setup (Supabase, OpenAI, Resend)
- **`tests/`** - Raporty test√≥w i test plany

### Kluczowe pliki:
- `PROJECT_STRUCTURE.md` - Struktura projektu (ROOT)
- `README.md` - G≈Ç√≥wny README (ROOT)
- `.clauderc` - Mapa pamiƒôci (ten plik)

---

## üêõ ZNANE PROBLEMY & WORKAROUNDS

### Problem: Turbopack cache
**Symptom:** Stare zmiany widoczne po hot reload
**Solution:** `npm run dev:clean` lub usu≈Ñ `.next/`

### Problem: Supabase session refresh
**Symptom:** U≈ºytkownik wylogowywany po czasie
**Solution:** Implementacja refresh tokenu w middleware (proxy.ts)

### Problem: Rate limiting w development
**Symptom:** Zbyt wiele request√≥w podczas devu
**Solution:** Wy≈ºsze limity dla localhost w production

---

## üîÑ WORKFLOW ROZWOJU

### Dodawanie nowej funkcji:
1. **Planowanie:** Zdefiniuj wymagania i API
2. **Baza danych:** Stw√≥rz migracjƒô (je≈õli potrzebna)
3. **Typy:** Wygeneruj typy z Supabase (`supabase gen types`)
4. **Server Actions:** Stw√≥rz funkcje w `lib/actions/`
5. **Komponenty:** Zbuduj UI w `components/`
6. **Strony:** Dodaj routing w `app/`
7. **Testy:** Testuj manualnie + skrypty
8. **Dokumentacja:** Zaktualizuj `docs/`

### Dodawanie nowej tabeli:
1. Stw√≥rz migracjƒô SQL w `supabase/migrations/`
2. Dodaj RLS policies
3. Wygeneruj typy TypeScript
4. Stw√≥rz Server Actions
5. Dodaj do dokumentacji

### Edycja istniejƒÖcej funkcji:
1. Znajd≈∫ komponent/action w strukturze
2. Sprawd≈∫ typy i RLS policies
3. Wprowad≈∫ zmiany
4. Testuj lokalnie
5. Deploy na Vercel (auto)

---

## üéì NAJLEPSZE PRAKTYKI

### Security
- Zawsze u≈ºywaj RLS policies
- Waliduj dane server-side (Zod)
- Nigdy nie exposeuj OPENAI_API_KEY w client code
- Rate limiting na wszystkich publicznych API
- Sanityzacja user input

### Performance
- Server Components jako domy≈õlne
- Dynamic imports dla ciƒô≈ºkich komponent√≥w
- Image optimization (Next.js Image)
- Kompresja obraz√≥w przed uploadem (browser-image-compression)
- React Query cache dla danych
- HNSW index dla wektor√≥w (szybsze ni≈º IVFFlat)

### UX
- Loading states (Suspense, skeletons)
- Error states (Error boundaries)
- Optimistic updates (React Query)
- Toast notifications (sonner)
- Mobile-first design
- Accessibility (ARIA labels, keyboard navigation)

### Code Quality
- TypeScript strict mode
- ESLint + Next.js rules
- Konsystentne nazewnictwo
- Komentarze dla skomplikowanej logiki
- Reusable components
- Single Responsibility Principle

---

## üìû KONTAKT & SUPPORT

### Autor
**Marcin Baszewski**
GitHub: [@negativepl](https://github.com/negativepl)

### Repository
https://github.com/negativepl/findsomeone

### Issues & Questions
GitHub Issues: https://github.com/negativepl/findsomeone/issues

### License
Non-Commercial MIT - Zobacz LICENSE file

---

## üîÆ ROADMAP (Przysz≈Çe funkcje)

### Planowane:
- [ ] Powiadomienia push (PWA)
- [ ] Geolokalizacja (mapa post√≥w)
- [ ] P≈Çatno≈õci online (Stripe)
- [ ] Wyr√≥≈ºnione og≈Çoszenia (boost)
- [ ] Statystyki u≈ºytkownika
- [ ] API publiczne (REST/GraphQL)
- [ ] Mobile app (React Native)
- [ ] Multi-language support (i18n)
- [ ] Advanced analytics dashboard
- [ ] Video support w og≈Çoszeniach

### W przygotowaniu:
- [ ] Improved AI moderation
- [ ] Better search filters
- [ ] Social sharing features

---

## üìå QUICK REFERENCE

### Wa≈ºne komendy:
```bash
npm run dev                    # Start dev server
npm run build                  # Production build
npm run start                  # Start production
npm run lint                   # Lint code
./clear-cache.sh              # Clear Next.js cache
```

### Wa≈ºne pliki:
- `lib/actions/` - Server Actions
- `lib/supabase/` - Supabase clients
- `lib/types/database.ts` - Typy bazy danych
- `app/api/` - API routes
- `components/ui/` - Komponenty UI (shadcn)
- `supabase/migrations/` - Migracje bazy
- `proxy.ts` - Middleware (refresh session)
- `next.config.ts` - Konfiguracja Next.js

### Admin access:
Sprawd≈∫ `profiles.is_admin = true` w bazie danych

### Supabase Dashboard:
https://supabase.com/dashboard

### OpenAI Dashboard:
https://platform.openai.com/

---

**Ostatnia aktualizacja:** 2025-11-06
**Wersja mapy pamiƒôci:** 1.0
**Status:** Production Ready ‚úÖ
